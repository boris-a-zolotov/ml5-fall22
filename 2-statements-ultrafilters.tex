\begin{definition}
    \textit{Предложение} в сигнатуре $\sigma$~— формула без свободных переменных.  

    \begin{equation*}
        \begin{aligned}
            \varphi^{\mathbb{A}} \in \{T, F\}, \\ 
            \varphi^{\mathbb{A}} = T \Longleftrightarrow \mathbb{A} \models \varphi.
        \end{aligned}
    \end{equation*}
\end{definition}

\begin{definition} 
    \textit{Моделью} данного множества предложения $\Gamma$ называется структура, в которой все предложения из $\Gamma$ истины. Если $\mathbb{A}$~— это модель, то иногда пишут $\mathbb{A} \models \Gamma$. 

    Если $\Gamma$~— множество предложений, $\varphi$~— предложение. Говорят, что $\varphi$ логически следует из $\Gamma$ ($\Gamma \models \varphi$), если $\varphi$ истино в любой модели $\Gamma$. 
\end{definition} 

\begin{definition}
    Предложение $\varphi$ называется тождественно истино, если оно истино в любой структуре. Иногда пишут $\models \varphi$. 
\end{definition}

\begin{stat} \ 
    \begin{itemize}
        \item $\Gamma \models \varphi$ тогда и только тогда, когда $\Gamma \cup \{\neg \varphi\}$ не имеет модели. 
        \item $\varphi$~— тождественная истина тогда и только тогда, когда $\models \varphi$. 
        \item $\Gamma$~— конечное; $\Gamma \models \varphi$ тогда и только тогда, когда $(\wedge \Gamma) \to \varphi$~— тожественная истина.
    \end{itemize}
\end{stat} 

\subsubsection{Ультрафильтры}

\begin{definition}
    Пусть $I$~— непустое множество. \textit{Фильтром} на множестве $I$ называется непустое множество $F \subseteq \Bool(I)$ (где $\Bool(I)$~— множество всех подмножеств), которое не содержит \(\emptyset \subset I\), а также замкнуто относительно пересечения:
    \[\forall\,A, B \in F\ \ A\cap B \in F,\]
и взятия надмножеств:
    \[\forall\,A \in F\ \ A \subseteq B \subseteq I\ \ \Longrightarrow\ \ B \in F.\]

    Фильтр $F$ называется \textit{ультрафильтром}, если $A \in F$ или $\overline{A} \in F$ для любого $A \subseteq I$. 
\end{definition} 

\begin{stat} \ \vspace{-4mm}
    \begin{enumerate}
        \item \label{ultraStatA} Фильтр $F$ является ультрафильтром тогда и только тогда, когда он является максимальным по включению среди всех фильтров (то есть, нет фильтра, который бы его расширял). 
        \item \label{ultraStatB} Пусть $F$~— ультрафильтр и $A, \: B \subseteq I$, тогда
		\begin{align*}
		   & A \in F\ \ \Longleftrightarrow\ \ \overline{A} \notin F, \\
		   & A \cup B \in F\ \ \Longleftrightarrow\ \ A \in F\text{ или }B \in F.
		\end{align*}
        \item \label{ultraStatC} Любой фильтр содержится в некотором ультрафильтре.
    \end{enumerate}
\end{stat}

\begin{proof} Докажем~\ref{ultraStatA}.

	Пусть $F$~— ультрафильтр. Утверждается, что нет фильтра $F'$, который содержал бы $F$ ($F' \supseteq F$). Предположим противное, т.е. что существует такое $A$, что оно принадлежит $F'$ и не принадлежит $F$. Раз $A \notin F$, то $\overline{A} \in F$. В силу того, что $F \subseteq F'$, то $\overline{A}$ также принадлежит $F'$. Таким образом, $\emptyset = A \cap \overline{A} \in F'$, противоречие. 
        
	В обратную сторону, $F$~— максимальный по включению фильтр. От противного, пусть есть множество $A \subseteq I$ такое, что $A, \overline{A} \notin F$. Рассмотрим
	\[ F' = \set*{X \subseteq I\ \middle\vert\ \exists\,B \in F\ A \cap B \subseteq X}. \]
    $F'$ должно быть фильтром (замкнутость вверх по включению понятна, замкнутость относительно пересечения также верна, так как если $X, Y \in F'$, $A \cap B \subseteq X$, $A \cap C \subseteq Y$ для $B, C \in F$, то $A \cap B \cap C \subseteq (X \cap Y)$. $B \cap C \in F$, а значит, $X \cap Y \in F'$; и последнее, если $\emptyset \in F'$, то получается очевидное противоречие из того, что $A \cap B$ всегда непусто — иначе $\overline{A}\supseteq B$, а F замкнуто относительно взятия надмножеств). 
        
        Докажем~\ref{ultraStatB}. Пусть $F$~— ультрафильтр. Одновременно $A$ и $\overline{A}$ принадлежать $F$ не могут. Имеем $A \in F \vee \overline{A} \in F$, откуда понятно. Второе утверждение очевидно в левую сторону.
        
        В другую сторону, имеем $A \cup B \in F$, предоположим противное. Пусть $A, B \notin F$, значит, $\overline{A}, \overline{B} \in F$, а тогда $\overline{A} \cap \overline{B} \in F$. По закону деМоргана, $\overline{A \cup B} \in F$, откуда $A \cup B \notin F$. 

        Докажем~\ref{ultraStatC}. Пусть имеется $F$. Утверждается, что существует ультрафильтр $F^*$, который сожержит $F$ ($F^* \supseteq F$). Данное утверждение нетривиально и в каком-то смысле схоже с аксиомой выбора. Применим лемму Цорна. 
        
        \begin{lemma}[Цорн]
            Пусть $(P; \leq)$~— частичный порядок, в котором всякая линейная цепь $A \supseteq P$ имеет верхнюю границу. Тогда в этом частичном порядке есть максимальный элемент. 
        \end{lemma} 

        Рассмотрим множество всех фильтров $P = \{G\text{~— фильтр }\mid F \subseteq G\}$, и порядок $\subseteq$.
        % Пусть $\mathfrak{F}$~— множество фильтров $F_1 \subseteq F_2 \vee F_2 \subseteq F$, а $F' = \bigcup \mathfrak{F}$. $F'$~— фильтр, что проверяется ручками. По лемме, существует $F^*$~— максимальное расширение. 
        Пусть $\mathfrak{F}$~— цепочка фильтров. Несложно проверить, что $F' = \bigcup\mathfrak{F}$ является фильтром, это верхняя грань цепочки. По лемме, существует $F^*$~— максимальное расширение. Оно является ультрафильтром.
\end{proof} 

\begin{exmpl} \ 
    \begin{itemize}
        \item Пусть есть $I$, тогда $\{I\}$~— фильтр. 
        \item Пусть $\emptyset \neq A \subseteq I$, тогда $F = \{X \subseteq I \mid A \subseteq X\}$~— фильтр. Является ультрафильтром тогда и только тогда, когда $|A|=1$. В таком случае называется \emph{главным ультрафильтром}.
            % Ещё можно дописать пример с точкой x в топологическом пространстве X, элементы фильтра -- все её окрестности. Только что с надмножеством? 
    \end{itemize}
\end{exmpl}

\begin{task}
    Если $I$ бесконечное, то в $P(I)$ есть неглавные ультрафильтры. Для доказательства рассматриваем $F = \{A \subseteq I \mid A\text{~— коконечно}\}$, и существующий по доказанному ранее $F^* \supseteq F$. 
\end{task} 

\subsubsection{Декартово и фильтрованное произведения структур} 

Пусть имеется некоторое проиндексированное семейство $\sigma$-структур $\{\mathbb{A}_i\}_{i \in I}$.

\begin{definition}[Декартово произведение]
	Определим \(\sigma\)-структуру на декартовом произведении нескольких \(\sigma\)-структур. Мы будем обозначать её \(\mathbb{A} = \prod_{i \in I} \mathbb{A}_i\).
    
	Носителем структуры будет множество
	   \[ A = \prod\limits_{i \in I} A_i =
	      \set*{a \colon I \longrightarrow \bigsqcup\limits_{i \in I} A_i
	      \ \ \middle\vert\ \ a(i) \in A_i}.\]

	Константы, функции и предикаты интерпретируются следующим образом:
   \begin{enumerate}
	\item \(c^{\mathbb{A}}(i) = c^{\mathbb{A}_i}\)~— отображение, возвращающее в каждой структуре соответствующую константу;
	\item \( \lr*{f^{\mathbb{A}}(a_1, \ldots, a_n)}(i) =
	          f^{\mathbb{A}_i}(a_1(i), \ldots, a_n(i)) \)~— действуем функцией в каждой структуре, собираем из образов элемент декартова произведения;
	\item \(P^{\mathbb{A}}(a_1, \ldots, a_n)\ \ \Longleftrightarrow\ \ 
	        P^{\mathbb{A}_i}(a_1(i), \ldots, a_n(i))\text{\ выполнен для всех\ }i \in I\).
   \end{enumerate}
\end{definition}

\begin{definition}[Фильтрованное произведение]
    Пусть $F$~— фильтр на множестве $I$. \emph{Фильтрованное произведение} нескольких структур (обозначается $\mathbb{A}_F$) получается факторизацией их декартова произведения по следующему отношению эквивалентности:
	\[a \equiv_F b\ \ \overset{\text{def}}{\Longleftrightarrow}\ \ 
	  \set*{i \in I\ \middle\vert\ a(i) = b(i)} \in F\]    
    (говорят, что $a(i) = b(i)$ \emph{для $F$-большинства $i$).}

    Носителем фильтрованного произведения будет фактор-множество \(A / {\equiv_F}\), состоящее из классов эквивалентности \(\set*{ \segment*{a}\ \middle\vert\ a \in A}\). Константы, функции и предикаты интерпретируются следующим образом:
    \begin{enumerate}
	\item $c^{\mathbb{A}_F} = \segment*{c^{\mathbb{A}}}$~— класс элемента, собранного из соответствующих констант во всех структурах;
	\item $f^{\mathbb{A}_F}\lr*{[a_1], \ldots, [a_n]} =
	      \segment*{f^{\mathbb{A}}\lr*{a_1, \ldots, a_n}}$~— надо проверить, что определено однозначно (потому что пересечение множеств фильтра принадлежит фильтру); 
	\item $P^{\mathbb{A}_F}([a_1], \ldots, [a_n])\ \ \Longleftrightarrow\ \ 
	       P^{\mathbb{A}_i} (a_1(i), \ldots, a_n(i))$ для $F$-большинства $i$. 
    \end{enumerate}
\end{definition} 

    Если $F$~— ультрафильтр, то $\mathbb{A}_{F}$ называется \textit{ультрапроизведением}.


\begin{theorem}[об ультрапроизведениях]
    Пусть $F$~— ультрафильтр на множестве $I$, $\mathbb{A}_i$~— семейство структур, $\varphi(x_1, \ldots, x_k)$~— $\sigma$-формула и пусть $a_1, \ldots, a_k \in \prod_i A_i$. Тогда $\mathbb{A}_F \models \varphi([a_1], \ldots, [a_k])$ тогда и только тогда, когда $\mathbb{A}_i \models \varphi(a_1(i), \ldots, a_n(i))$ для $F$-большинства индексов.
\end{theorem} 

\subsubsection{Теорема Гёделя о компактности} 

\begin{theorem}
    Бесконечное множество предложений $\Gamma$ имеет модель тогда и только тогда, когда каждое его конечное подмножество $\Gamma^\prime$ имеет модель.
\end{theorem}


